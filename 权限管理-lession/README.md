---
typora-root-url: images
---

# JEECG平台权限设计

> # 一、权限的设计概念

JEECG封装了完善的用户权限模块，支持菜单权限，列表权限，表单权限，数据权限。数据权限功能已实现极致： 支持行级、列级、字段级控制，实现不同人看不同数据，不同人对同一个页面操作不同字段。系统按钮权限和表单权限原来是正控制，只有授权的人才有权限，未授权看不到对应按钮;（admin拥有超级权限，不受控制）

用户权限模块：指用户信息及用户权限信息数据。一个用户可以分配多个角色；也可以隶属于多个组织结构；多个组织机构情况下，登录需要选择机构登录，方便数据权限控制。多个组织登录情况如下：

![1](/1.png)

管理员可以对用户进行管理，如果用户已经失效可以直接冻结该用户禁止其登录，新开的用户需要激活后才能登录

![2](/2.png)



> # 二、权限的对象

JEECG权限设计，采用用户、角色、菜单、组织机构来进行组建，角色为主要授权对象，组织机构可以分配角色。 菜单类型分两种：权限类型和菜单类型

- 菜单类型： 菜单类型的菜单，在首页菜单展示和访问使用
- 权限类型： 权限类型的菜单，在首页菜单不做展示，只做权限控制使用

### 1.用户管理

用户管理，用户可以分配多个角色；也可以隶属于多个组织机构，多个组织机构情况下，登录需要选择机构登录，方便数据权限控制；

![3](/3.png)



### 2.角色管理

角色是权限组单位，通过角色管理菜单权限。

![4](/4.png)



### 3.菜单管理

菜单管理，用来做首页菜单管理和权限管理，权限包括：菜单访问权限、按钮权限、表单权限、数据权限。

![5](/5.png)



### 4.组织机构管理

组织机构管理，支持集团模式多个分公司，第一级默认是公司类型，从二级开始可设置部门和岗位，部门和岗位通过类型区分；组织机构可以单独设置角色；

![6](/6.png)



> # 三、数据权限规则

### 一、功能说明

列表数据权限，主要通过数据权限控制行数据，让不同的人有不同的查看数据规则； 比如： 销售人员只能看自己的数据；销售经理可以看所有下级销售人员的数据；财务只看金额大于5000的数据等等；   

### 二、数据权限分两大类型

| 序号 | 类型       | 规则字段区别                                | 说明                               |
| ---- | ---------- | ------------------------------------------- | ---------------------------------- |
| 1    | 编码方式   | 规则字段是驼峰写法，对应hibernate实体的字段 | 编码模式（通过代码生成器生成代码） |
| 2    | Online方式 | 规则字段是下划线写法，对应表的字段          | Online模式（在线表单模式，无代码） |

### 三、数据权限规则篇

#### 1.当前用户上下文变量

注意：数据权限配置，规则值可以填写系统上下文变量（当前登录人信息），从而根据当前登录人信息进行权限控制。

| 编码             | 描述                 |
| ---------------- | -------------------- |
| sys_user_code    | 当前登录用户登录账号 |
| sys_user_name    | 当前登录用户真实名称 |
| sys_date         | 当前系统日期         |
| sys_time         | 当前系统时间         |
| sys_company_code | 当前登录用户公司编号 |
| sys_org_code     | 当前登录用户部门编号 |

规则值，配置写法如下：#{sys_user_code}   



> # 四、如何生成代码

> > #### 首先登录网站===>在线开发===>Online表单开发===>创建表单
> >
> > ![7](/7.png)

> > 创建表单后需要先同步到数据库，然后点击<u>**代码生成**</u> 。可以根据弹出的对话框选择代码生成的存放位置。然后copy到项目中。
> >
> > 另外一种生成方案是使用Java中的GUI生成代码。『官方建议使用Online生成』。直接run As test包下的JeecgOneGUI.java 文件然后弹出录入界面
> >
> > ![8](/8.png)
>
> ```html
> <font color="red">如果是基础功能不建议选择生成代码。直接在线生成就可以，如果有需要做开发API接口给前台使用的则需要生成代码放到项目中以便增加注解【API采用Swagger】，只有在方法上加入`@ApiOperation`注解才能在Swagger中显示。</font>
> ```
>
>

